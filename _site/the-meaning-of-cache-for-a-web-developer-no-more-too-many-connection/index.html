
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Giulio De Donato | liuggio :: The meaning of Cache for a web developer no more too many connection</title>
    
    <meta name="description" content="Cache definitions and implementations">
    
    <meta name="author" content="Giulio De Donato">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!--[if lt IE 9]>
    <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link href="/assets/themes/readable-liuggio/bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <link href="/assets/themes/readable-liuggio/bootstrap/css/bootstrap-responsive.min.css" rel="stylesheet">


    <link href="/assets/themes/readable-liuggio/css/style.css?body=1" rel="stylesheet" type="text/css" media="all">
    <link rel="stylesheet" href="/assets/themes/readable-liuggio/css/font-awesome.css">
    <!-- Google Web Font-->
    <link href='http://fonts.googleapis.com/css?family=Droid+Serif:400,700,400italic,700italic' rel='stylesheet'
          type='text/css'>
    <link href='http://fonts.googleapis.com/css?family=Droid+Sans:400,700' rel='stylesheet' type='text/css'>


</head>

<body>
<div class="container">
    <header>
        <div id="header">
            <div class="logo span6"><img src="/assets/themes/readable-liuggio/img/welcometothebundle-logo.png"></div>
            <h1><a title="Blog of Giulio De Donato" id="sitename" href="http://www.welcometothebundle.com/">Welcome to the bundle</a></h1>

            <h2>Best Practice, symfony2, developing, and fluffs.</h2>
        </div>
    </header>


<!-- paulirish.com/2008/conditional-stylesheets-vs-css-hacks-answer-neither/ -->
<!--[if lt IE 7]> <html class="no-js ie6 oldie" lang="en"> <![endif]-->
    <section id="content">
        <div class="row">
            <aside class="span3">
                <div class="well">
                    <p align="center"><img
                            src="http://www.gravatar.com/avatar/662a52953053d94a145a00df9da9f0d2.png?size=48">
                    </p>
                    <p style="font-size:95%">I'm liuggio (aka <a href="https://plus.google.com/115690008178168800202?rel=author" rel="author" title="Giulio De Donato">Giulio De Donato</a>)
                         tons of lines of code ago I took a degree in Computer Science, I'm the
                        lead developer for Terravision and I love open source. I can't stop studying, you could find me in some conference, exactly now I'm in the center of Rome.</p>
                </div>
                <!-- start sticky section
#################################################
                -->
                <div class="well">
                    <div class="center" align="center">
                        <a href="https://github.com/liuggio" title="Giulio De Donato github projects"
                           target="_blank"><img src="/assets/themes/readable-liuggio/img/github_blue_black_cat_32.png"
                                                alt="liuggio's gravatar"></a>
                        <a href="http://twitter.com/liuggio" title="Giulio De Donato twitter page"
                           target="_blank"><img
                                src="/assets/themes/readable-liuggio/img/1345542601_Twitter_32x32.png"
                                alt="liuggio twitter page"></a>
                        <a href="http://www.linkedin.com/profile/view?id=94597934&"
                           title="Giulio De Donato Linkedin profile" target="_blank"><img
                                src="/assets/themes/readable-liuggio/img/1345542710_social_linkedin_box_blue.png"
                                width=34
                                alt="Giulio De Donato Linkedin profile"></a>
                        <a href="http://www.slideshare.net/liuggio"
                           title="Giulio De Donato slideshare presentations" target="_blank"><img
                                src="/assets/themes/readable-liuggio/img/slideshare.png" width=34
                                alt="Giulio De Donato slideshare presentations" width=30></a>
                    </div>
                    <div class="center">
                        <div align="center" class="twitter-cnt">
                            <a href="https://twitter.com/liuggio" class="twitter-follow-button"
                               data-show-count="false" data-size="large" data-dnt="true" title="Follow Giulio De Donato">Follow
                                @liuggio</a>
                            <script>!function (d, s, id) {
                                var js, fjs = d.getElementsByTagName(s)[0];
                                if (!d.getElementById(id)) {
                                    js = d.createElement(s);
                                    js.id = id;
                                    js.src = "//platform.twitter.com/widgets.js";
                                    fjs.parentNode.insertBefore(js, fjs);
                                }
                            }(document, "script", "twitter-wjs");</script>
                        </div>
                        <div align="center">
                            <a href="#">back to top</a>
                        </div>
                    </div>
                </div>

                <!-- end sticky section
                ================================================== -->
                <div class="">
                    <h2>Categories</h2>
                    <ul>
                        
                        


  
     
    	<li><a href="/categories.html#tips-ref">
    		tips <span>1</span>
    	</a></li>
     
    	<li><a href="/categories.html#award-ref">
    		award <span>1</span>
    	</a></li>
     
    	<li><a href="/categories.html#cache-ref">
    		cache <span>1</span>
    	</a></li>
     
    	<li><a href="/categories.html#hack-ref">
    		hack <span>1</span>
    	</a></li>
     
    	<li><a href="/categories.html#bdd-ref">
    		bdd <span>1</span>
    	</a></li>
     
    	<li><a href="/categories.html#phpunit-ref">
    		phpunit <span>1</span>
    	</a></li>
     
    	<li><a href="/categories.html#conference-ref">
    		conference <span>1</span>
    	</a></li>
     
    	<li><a href="/categories.html#manifesto-ref">
    		manifesto <span>1</span>
    	</a></li>
     
    	<li><a href="/categories.html#cloud-ref">
    		cloud <span>1</span>
    	</a></li>
     
    	<li><a href="/categories.html#statsd-ref">
    		statsd <span>1</span>
    	</a></li>
    
  


                    </ul>

                </div>
                <div class="">
                    <h2>Tags</h2>
                    <ul class="tag_box">
                        
                        


  
     
    	<li><a href="/tags.html#test-ref">test <span>1</span></a></li>
     
    	<li><a href="/tags.html#tvision-ref">tvision <span>1</span></a></li>
     
    	<li><a href="/tags.html#assets-ref">assets <span>3</span></a></li>
     
    	<li><a href="/tags.html#tdd-ref">tdd <span>1</span></a></li>
     
    	<li><a href="/tags.html#automate-ref">automate <span>1</span></a></li>
     
    	<li><a href="/tags.html#guard-ref">guard <span>1</span></a></li>
     
    	<li><a href="/tags.html#vagrant-ref">vagrant <span>1</span></a></li>
     
    	<li><a href="/tags.html#redis-ref">redis <span>1</span></a></li>
     
    	<li><a href="/tags.html#phpspec-ref">phpspec <span>1</span></a></li>
     
    	<li><a href="/tags.html#optimization-ref">optimization <span>1</span></a></li>
     
    	<li><a href="/tags.html#rackspace-ref">rackspace <span>1</span></a></li>
     
    	<li><a href="/tags.html#speaker-ref">speaker <span>1</span></a></li>
     
    	<li><a href="/tags.html#servergrove-ref">servergrove <span>1</span></a></li>
     
    	<li><a href="/tags.html#assetic-ref">assetic <span>2</span></a></li>
     
    	<li><a href="/tags.html#code-inspection-ref">code-inspection <span>1</span></a></li>
     
    	<li><a href="/tags.html#coding-ref">coding <span>1</span></a></li>
     
    	<li><a href="/tags.html#php-ref">php <span>9</span></a></li>
     
    	<li><a href="/tags.html#github-ref">github <span>1</span></a></li>
     
    	<li><a href="/tags.html#APC-ref">APC <span>1</span></a></li>
     
    	<li><a href="/tags.html#HTTP-ref">HTTP <span>1</span></a></li>
     
    	<li><a href="/tags.html#cache-ref">cache <span>2</span></a></li>
     
    	<li><a href="/tags.html#bdd-ref">bdd <span>1</span></a></li>
     
    	<li><a href="/tags.html#phpunit-ref">phpunit <span>2</span></a></li>
     
    	<li><a href="/tags.html#conference-ref">conference <span>1</span></a></li>
     
    	<li><a href="/tags.html#graphite-ref">graphite <span>1</span></a></li>
     
    	<li><a href="/tags.html#cdn-ref">cdn <span>1</span></a></li>
     
    	<li><a href="/tags.html#doctrine2-ref">doctrine2 <span>1</span></a></li>
     
    	<li><a href="/tags.html#tutorial-ref">tutorial <span>1</span></a></li>
     
    	<li><a href="/tags.html#team-ref">team <span>1</span></a></li>
     
    	<li><a href="/tags.html#statsd-ref">statsd <span>2</span></a></li>
     
    	<li><a href="/tags.html#bitbucket-ref">bitbucket <span>1</span></a></li>
     
    	<li><a href="/tags.html#bundle-ref">bundle <span>3</span></a></li>
     
    	<li><a href="/tags.html#symfony2-ref">symfony2 <span>5</span></a></li>
    
  



                    </ul>
                </div>
            </aside>

            <!-- start content section
            ================================================== -->
            <div class="span9">
                
<div class="span9">
    <div class="page-header">
        <div class="row">
            <h1 class="span8">The meaning of Cache for a web developer no more too many connection 
            </h1>
          <div class="span1 right bottom sticky">
               <a href="https://twitter.com/share" class="twitter-share-button" data-via="liuggio" data-size="large"
                  data-count="none" data-dnt="true">Tweet</a>
               <script>!function (d, s, id) {
                   var js, fjs = d.getElementsByTagName(s)[0];
                   if (!d.getElementById(id)) {
                       js = d.createElement(s);
                       js.id = id;
                       js.src = "//platform.twitter.com/widgets.js";
                       fjs.parentNode.insertBefore(js, fjs);
                   }
               }(document, "script", "twitter-wjs");</script>
              <!-- todo:<div class="inner">back to the top</div>-->
           </div>
        </div>
        <hr>
        <div class="row">
            <div class="span4">
                <div class="date"><span>22 February 2013</span></div>
            </div>

            <div class="span5">
                
                <ul class="tag_box">
                    
                    


  
     
    	<li><a href="/tags.html#HTTP-ref">HTTP <span>1</span></a></li>
     
    	<li><a href="/tags.html#cache-ref">cache <span>2</span></a></li>
     
    	<li><a href="/tags.html#php-ref">php <span>9</span></a></li>
     
    	<li><a href="/tags.html#APC-ref">APC <span>1</span></a></li>
     
    	<li><a href="/tags.html#redis-ref">redis <span>1</span></a></li>
     
    	<li><a href="/tags.html#assets-ref">assets <span>3</span></a></li>
    
  



                </ul>
                
            </div>
        </div>

    </div>

    <article>


        <p>In the place of Mr. Obvious I&#8217;m going to describe what really cache means, there is a lot of confusion between what the cache <strong>is</strong>, what it <strong>does</strong> and all the possible <strong>uses</strong> and <strong>implementations</strong>.</p>

<p>All the fuss comes from the use<strong>s</strong> of that polysemous word.</p>

<h2 id='definition'>Definition:</h2>

<p>We should start from <strong>Wikipedia</strong>, “Cache is a component that transparently stores data so that future requests for that data can be served faster.”</p>

<p>So instead of doing a time consuming calculation if you already &#8216;remember&#8217; the result answer it.</p>

<p>The concept seems simple, the problem is it could be used in a myriad of ways.</p>

<p>Important words:</p>

<ul>
<li>
<p>A <strong>Cache Hit</strong> happens if the Cache contains the answer.</p>
</li>

<li>
<p>A <strong>Cache Miss</strong> happens if the Cache doesn’t contain the answer.</p>
</li>
</ul>

<h2 id='some_standard_code'>Some &#8216;standard&#8217; Code:</h2>

<p><strong>Doctrine</strong> defines the cache interface with <a href='https://github.com/doctrine/cache/blob/master/lib/Doctrine/Common/Cache/Cache.php'>Doctrine/Common/Cache/Cache.php</a></p>

<pre><code>function fetch($id);
function contains($id);
function save($id, $data, $lifeTime = 0);
function delete($id);</code></pre>

<p><strong>PHP fig-standards</strong> proposed the cache with <a href='https://github.com/php-fig/fig-standards/issues?labels=Cache&amp;page=1&amp;state=open'>proposed/PSR-Cache.md</a></p>

<h2 id='implementations'>Implementations:</h2>

<p>As web developers the cache is an essential tool, we have to divide the cache features from its implementations.</p>

<h3 id='1_http_cache'>1. HTTP Cache</h3>

<h4 id='description'>Description</h4>

<p>OK - describing the HTTP Cache is a huge task, and heaps of great developers already did this (<a href='https://www.google.com/search?q=http+cache'>google</a>, <a href='http://www.slideshare.net/fabpot/caching-on-the-edge'>fabpot/caching-on-the-edge</a>), the concept in few lines is that you are a web developer, and the web works with the HTTP Protocol, so you HAVE to study the HTTP Protocol.</p>

<p>I won&#8217;t go in depth with HTTP Protocol and Cache, but understanding the HTTP protocol turns a developer in a web developer.</p>

<p>The actors in the HTTP Cache are: your web-server, your reverse proxy (as Varnish or Squid), the Shared cache server<strong>s</strong> (more than one) and the client browser cache.</p>

<p>This is the best Cache and the most powerful, you could create many cache layers on your application, but if you set up the HTTP headers properly the first time, the next requests will be served for free. <strong>The least expensive query is the query you never had</strong></p>

<h4 id='enemies'>Enemies</h4>

<p>An enemy of your mental health is the <strong>invalidation</strong>, do not waste time trying to find a solutions for invalidating cache, choose only the best validation.</p>

<p>The HTTP cache enemy? Cookies and Sessions (see how to solve it thanks to <a href='https://www.google.it/search?client=ubuntu&amp;channel=fs&amp;q=ESI+cache&amp;ie=utf-8&amp;oe=utf-8&amp;redir_esc=&amp;ei=P6QnUbS5AsbKtAbdQQ'>ESI</a>)</p>

<h4 id='best_tools'>Best Tools</h4>

<p>Varnish / Squid</p>

<h3 id='2_opcode'>2. Opcode</h3>

<h4 id='description'>Description</h4>

<p>“APC is a performance-enhancing extension. It should not be confused with a magic pill, although having it around does provide a positive impact on performance! If configured incorrectly, APC can cause unexpected behaviour, however when implemented optimally APC can be a useful weapon in your arsenal.” <a href='http://techportal.inviqa.com/2010/10/07/understanding-apc/'>read more on understanding APC</a>.</p>

<p>This should be a must for you my dear PHP developer.</p>

<h4 id='best_tools'>Best Tools</h4>

<p>APC o Zend Optimizer+.</p>

<h3 id='3_the_cache_of_your_application__framework'>3. The Cache of your application / framework</h3>

<h4 id='description'>Description</h4>

<p>The framework is a tool that should helps you sort and easily create the logic of your domain, to do this it provides files and configurators, which are usually elaborated in PHP files, the cache is used to not process at each request.</p>

<p>For example with Symfony2 in the application cache folders you will find, Url creator files, Proxy Classes, Configuration files (ini, yml, xml) converted to PHP files, Annotations etc&#8230;</p>

<h4 id='best_tools'>Best Tools</h4>

<p>Configuration file to PHP then any Opcode.</p>

<h3 id='4_template_and_file_system_caching'>4. Template and File System Caching</h3>

<h4 id='description'>Description</h4>

<p>Good Template engines, Smarty and Twig provide a caching system using precompiled pieces of code already in a file into the file system.</p>

<h4 id='best_tools'>Best Tools</h4>

<p>There is no better cache then the Opcode for serving this type of file.</p>

<p>Recently a Pull Request has also been refused, it allows Twig to use any other type of cache <a href='https://github.com/fabpot/Twig/issues/728'>issue on github</a>.</p>

<h3 id='5_query_results'>5. Query Results</h3>

<h4 id='description'>Description</h4>

<p>You are Object Oriented programmers, do not waste your time normalizing the database, if you have too many JOIN delegated the speed to the cache layer.</p>

<p>Queries can be large objects, better to put a centralized server, The enemy is the period of validity vs. freshness, and the size of the query.</p>

<h4 id='best_tools'>Best Tools</h4>

<p>Redis/Memcache(d), but <a href='http://www.slideshare.net/uptimeforce/postgresql-query-cache-pqc'>PostgreSQL-cache</a> has a great internal cache layer, also MySQL has it.</p>

<h3 id='6_query_caching'>6. Query Caching</h3>

<h4 id='description'>Description</h4>

<p>Some ORM as Doctrine stores the query creation in order to not process it twice.</p>

<h4 id='best_tools'>Best Tools</h4>

<p>APC or Redis/Memcache(d)</p>

<h2 id='simple_rules'>Simple Rules</h2>

<ol>
<li>If you want to not process content of ini files or xml files or yml files, you could convert to PHP or you could store data see <strong>3.</strong></li>

<li>If you want to cache PHP files use Opcode caching.</li>

<li>If you want to store variable contents or Objects use Redis, Memcache(d), or you could also use APC <a href='http://php.net/manual/en/function.apc-store.php'>apc-store</a> (suggested if you have a single web server)</li>

<li>If you have provide some content use HTTP Cache always and in order to serve assets (file css, js, static content) use some famous CDN or Nginx or some free/cheap cdn service on the net.</li>
</ol>

<h2 id='other_cache_mechanisms'>Other Cache mechanisms</h2>

<ul>
<li>
<p>Pre-Caching/Cacheback, sometimes you need to have some data already available and you don&#8217;t want that the first request wait some slow task <a href='http://codeinthehole.com/writing/cacheback-asynchronous-cache-refreshing-for-django'>cacheback-asynchronous-cache-refreshing-for-django</a></p>
</li>

<li>
<p><a href='http://www.howtoforge.com/why-you-should-always-use-nginx-with-microcaching'>Microcaching</a>, few seconds of cache, useful for GET or <strong>POST</strong>. I said <strong>POST</strong>, do not it seemed strange to you? If you jumped on the chair is ok, POST on cache is insane, unless you do not want to avoid double click.</p>
</li>

<li>
<p>Before there were static website in HTML, then dynamic languages ​​and databases, and we finally came to the static pages again, this blog has been developed with <a href='http://jekyllbootstrap.com/lessons/jekyll-introduction.html'>jekyll</a>,</p>
</li>
</ul>

    </article>
    <hr>
    <div class="pagination">
        <ul class="pager">
            
            <li class="prev"><a href="/phpunit-vs-phpspec-theory-on-behaviour-driven-development" title="PHPUnit vs PHPSpec: theory on Behaviour Driven Development 1/3">&larr;
                Previous - PHPUnit vs PHPSpec: theory on Behaviour Driven Development 1/3</a></li>
            
            <li><a href="/index.html">Archive</a></li>
            
            <li class="next"><a href="/doctrine2-tracking-policy" title="Doctrine2 tracking policy">Next - Doctrine2 tracking policy &rarr;</a>
            </li>
            
        </ul>
    </div>
    <hr>
    


  <div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_developer = 1;
    var disqus_shortname = 'welcometothebundle'; // required: replace example with your forum shortname
    
    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>




</div>
  
 


            </div>
        </div>
    </section>


    <hr>
    <footer>
        <p>&copy; liuggio 2012
            <a href="http://jekyllbootstrap.com" target="_blank" title="The Definitive Jekyll Blogging Framework">Jekyll
                Bootstrap</a>,
            <a href="http://twitter.github.com/bootstrap/" target="_blank">Twitter Bootstrap</a>,
            <a href="http://github.com" target="_blank">GitHub</a>,
            <a href="http://bootswatch.com/" target="_blank">Bootswatch</a>
        </p>

        <div id="footer"></div>
    </footer>
</div>
</div>
<!-- /container -->
<script src="/assets/themes/readable-liuggio/bootstrap/js/jquery-1.8.3.min.js" type="text/javascript"></script>

<script type="text/javascript">
    var links = document.links;
    for (var i = 0, linksLength = links.length; i < linksLength; i++) {
        if (links[i].hostname != window.location.hostname) {
            links[i].target = '_blank';
        }
    }
    var links = document.links;
    for (var i = 0, linksLength = links.length; i < linksLength; i++) {

        if (links[i].href == 'http://www.slideshare.net/liuggio/rationally-boost-your-symfony2-application-with-caching-tips-and-monitoring') {

            //dirty solution in order to add slideshare frame into github Jekyll
            links[i].innerHTML = '<iframe src="http://www.slideshare.net/slideshow/embed_code/14625769?rel=0" width="512" height="421" frameborder="0" marginwidth="0" marginheight="0" scrolling="no" style="border:1px solid #CCC;border-width:1px 1px 0;margin-bottom:5px" allowfullscreen webkitallowfullscreen mozallowfullscreen> </iframe><div style="margin-bottom:5px"> <strong> <a href="http://www.slideshare.net/liuggio/rationally-boost-your-symfony2-application-with-caching-tips-and-monitoring" title="Rationally boost your symfony2 application with caching tips and monitoring" target="_blank">Rationally boost your symfony2 application with caching tips and monitoring</a></div>';
            break;
        }
    }

</script>
<script type="text/javascript">
  var analytics=analytics||[];analytics.load=function(e){var t=document.createElement("script");t.type="text/javascript",t.async=!0,t.src=("https:"===document.location.protocol?"https://":"http://")+"d2dq2ahtl5zl1z.cloudfront.net/analytics.js/v1/"+e+"/analytics.min.js";var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(t,n);var r=function(e){return function(){analytics.push([e].concat(Array.prototype.slice.call(arguments,0)))}},i=["identify","track","trackLink","trackForm","trackClick","trackSubmit","pageview","ab","alias","ready"];for(var s=0;s<i.length;s++)analytics[i[s]]=r(i[s])};
  analytics.load("wdoo4hzofo");
</script>

<script type="text/javascript">

    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-37195869-1']);
    _gaq.push(['_trackPageview']);

    (function () {
        var ga = document.createElement('script');
        ga.type = 'text/javascript';
        ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(ga, s);
    })();

</script>


<script>
    $(function () { // document ready
        if (!!$('.sticky').offset()) { // make sure ".sticky" element exists
            var stickyTop = $('.sticky').offset().top; // returns number
            $(window).scroll(function () { // scroll event
                var windowTop = $(window).scrollTop(); // returns number
                if (stickyTop < windowTop) {
                    $('.sticky').css({ position:'fixed', top:0, right:0 });
                    $('.sticky').addClass("well");
                    $('.sticky .inner').show();

                }
                else {
                    $('.sticky').css('position', 'static');
                    $('.sticky').removeClass("well").addClass("span1");
                    $('.sticky .inner').hide();
                }
            });
        }
    });
</script>

</body>
</html>

